<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Management Workflows</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%); min-height: 100vh; }
        .glass-card { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(239, 68, 68, 0.2); }
        .workflow-box { background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(239, 68, 68, 0.3); font-family: 'Courier New', monospace; }
        .phase-automated { border-left: 4px solid #22c55e; }
        .phase-manual { border-left: 4px solid #f59e0b; }
        .phase-stop { border-left: 4px solid #ef4444; }
        .phase-context { border-left: 4px solid #3b82f6; }
        .phase-soc { border-left: 4px solid #8b5cf6; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body class="text-gray-100">
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 glass-card border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-lg bg-red-500/20 flex items-center justify-center">
                        <i class="fas fa-bug text-red-400"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-semibold text-white">Vulnerability Management Workflows</h1>
                        <p class="text-xs text-gray-400">End-to-End Enterprise Process (11 Phases)</p>
                    </div>
                </div>
                <a href="workflows-index.html" class="text-gray-400 hover:text-red-400 transition-colors">
                    <i class="fas fa-th-large mr-2"></i>All Workflows
                </a>
            </div>
        </div>
    </nav>

    <div class="pt-24 pb-12 px-6">
        <div class="max-w-6xl mx-auto space-y-8">

            <!-- Key Concept Box -->
            <div class="bg-blue-500/10 border border-blue-500/50 rounded-xl p-6">
                <h3 class="text-blue-400 font-bold text-lg mb-3"><i class="fas fa-lightbulb mr-2"></i>Key Concept: Vulnerability Management â‰  SOC Workflow</h3>
                <p class="text-gray-300 text-sm mb-4">
                    Vulnerability management is <strong class="text-white">NOT</strong> a SOC incident workflow. SOC only engages when vulnerabilities are actively exploited. 
                    The vulnerability pipeline produces <strong class="text-white">prioritized findings for remediation teams</strong>, not SOC tickets.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div class="bg-green-500/10 border border-green-500/30 rounded-lg p-3">
                        <p class="text-green-400 font-semibold mb-1">âœ… Vulnerability Management Output:</p>
                        <ul class="text-gray-400 text-xs space-y-1">
                            <li>â€¢ Power BI dashboards</li>
                            <li>â€¢ CSV exports for analysts</li>
                            <li>â€¢ ServiceNow/Jira tickets to asset owners</li>
                            <li>â€¢ SLA tracking reports</li>
                        </ul>
                    </div>
                    <div class="bg-purple-500/10 border border-purple-500/30 rounded-lg p-3">
                        <p class="text-purple-400 font-semibold mb-1">âš¡ When SOC Gets Involved:</p>
                        <ul class="text-gray-400 text-xs space-y-1">
                            <li>â€¢ NGFW detects exploit traffic</li>
                            <li>â€¢ EDR detects suspicious behavior</li>
                            <li>â€¢ Correlation rule links activity to known vuln</li>
                            <li>â€¢ Then â†’ Sentinel Incident â†’ SOC Investigation</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Legend -->
            <div class="glass-card rounded-xl p-4">
                <h3 class="text-white font-bold mb-3"><i class="fas fa-info-circle text-red-400 mr-2"></i>Legend</h3>
                <div class="flex flex-wrap gap-6 text-sm">
                    <div class="flex items-center space-x-2">
                        <div class="w-4 h-4 bg-green-500 rounded"></div>
                        <span class="text-gray-300">Automated</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-4 h-4 bg-blue-500 rounded"></div>
                        <span class="text-gray-300">Enrichment/Logic</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-4 h-4 bg-yellow-500 rounded"></div>
                        <span class="text-gray-300">Manual (Human)</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-4 h-4 bg-red-500 rounded"></div>
                        <span class="text-gray-300">Stop Point / Decision</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-4 h-4 bg-purple-500 rounded"></div>
                        <span class="text-gray-300">SOC (Only When Needed)</span>
                    </div>
                </div>
            </div>

            <!-- PHASE 1 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">1.</span> Vulnerability Data Generation (Source of Truth)
                </h2>
                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-radar mr-2"></i>1.1 Qualys / TVM Scan Execution</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           VULNERABILITY SCANNING SOURCES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚           QUALYS VMDR           â”‚       â”‚      MICROSOFT DEFENDER TVM      â”‚        â”‚
â”‚   â”‚                                 â”‚       â”‚                                 â”‚        â”‚
â”‚   â”‚  Scheduled authenticated scans  â”‚       â”‚  Continuous exposure assessment â”‚        â”‚
â”‚   â”‚  (weekly / daily)               â”‚       â”‚                                 â”‚        â”‚
â”‚   â”‚                                 â”‚       â”‚                                 â”‚        â”‚
â”‚   â”‚  Produces:                      â”‚       â”‚  Produces:                      â”‚        â”‚
â”‚   â”‚  â”œâ”€â”€ CVE identifiers            â”‚       â”‚  â”œâ”€â”€ Vulnerabilities            â”‚        â”‚
â”‚   â”‚  â”œâ”€â”€ CVSS scores                â”‚       â”‚  â”œâ”€â”€ Software inventory         â”‚        â”‚
â”‚   â”‚  â”œâ”€â”€ Detection proofs           â”‚       â”‚  â”œâ”€â”€ Exploitability indicators  â”‚        â”‚
â”‚   â”‚  â””â”€â”€ Detection timestamps       â”‚       â”‚  â””â”€â”€ Exposure metrics           â”‚        â”‚
â”‚   â”‚                                 â”‚       â”‚                                 â”‚        â”‚
â”‚   â”‚  Coverage:                      â”‚       â”‚  Coverage:                      â”‚        â”‚
â”‚   â”‚  â€¢ Infrastructure               â”‚       â”‚  â€¢ Endpoints                    â”‚        â”‚
â”‚   â”‚  â€¢ Servers                      â”‚       â”‚  â€¢ Servers with MDE             â”‚        â”‚
â”‚   â”‚  â€¢ Network devices              â”‚       â”‚  â€¢ Workstations                 â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                        THESE TOOLS ANSWER:                                       â”‚  â”‚
â”‚   â”‚                  "What vulnerabilities exist and where?"                         â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- PHASE 2 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">2.</span> Data Ingestion into Sentinel (Raw Signals)
                </h2>
                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-database mr-2"></i>2.1 Ingestion Paths</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              DATA INGESTION INTO SENTINEL                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚       QUALYS        â”‚                      â”‚         LOG ANALYTICS               â”‚ â”‚
â”‚   â”‚                     â”‚â”€â”€â”€â”€ API Connector â”€â”€â–¶â”‚                                     â”‚ â”‚
â”‚   â”‚  Scanner Results    â”‚     / Logic App      â”‚  Custom Table: QualysVuln_CL        â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚                                     â”‚ â”‚
â”‚                                                â”‚  TVM Tables (Native):               â”‚ â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚  â€¢ DeviceTvmSoftwareVulnerabilities â”‚ â”‚
â”‚   â”‚   DEFENDER TVM      â”‚                      â”‚  â€¢ DeviceTvmSecureConfigAssessment  â”‚ â”‚
â”‚   â”‚                     â”‚â”€â”€ Native Connector â”€â–¶â”‚  â€¢ DeviceTvmSoftwareInventory       â”‚ â”‚
â”‚   â”‚  Continuous Data    â”‚                      â”‚                                     â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  AT THIS STAGE:                                                                  â”‚  â”‚
â”‚   â”‚  â”œâ”€â”€ Data is RAW                                                                â”‚  â”‚
â”‚   â”‚  â”œâ”€â”€ HIGH VOLUME (thousands of findings)                                        â”‚  â”‚
â”‚   â”‚  â””â”€â”€ NOT ACTIONABLE without enrichment                                          â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  âŒ NO SOC INVOLVEMENT HERE                                                      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- PHASE 3 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">3.</span> Enrichment & Contextualization (Critical Step)
                    <span class="ml-3 px-3 py-1 bg-emerald-500/20 text-emerald-400 text-sm rounded-full">YOUR AUTOMATION</span>
                </h2>
                <div class="bg-emerald-500/10 border border-emerald-500/50 rounded-xl p-4 mb-4">
                    <p class="text-emerald-400 font-bold"><i class="fas fa-star mr-2"></i>This is where YOUR automation and correlation logic lives</p>
                </div>
                <div class="workflow-box rounded-xl p-6 mb-4 phase-context">
                    <h3 class="text-blue-400 font-bold mb-4"><i class="fas fa-layer-group mr-2"></i>3.1 External Enrichment Sources</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ENRICHMENT DATA SOURCES                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ EPSS (Exploit Prediction Scoring System) - FIRST.org                             â”‚ â”‚
â”‚   â”‚ Adds: Probability of exploitation in next 30 days (0.0 - 1.0)                    â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ CISA KEV (Known Exploited Vulnerabilities)                                        â”‚ â”‚
â”‚   â”‚ Adds: Boolean flag - Is this CVE being actively exploited in the wild?           â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ CMDB / Asset Criticality Watchlist                                                â”‚ â”‚
â”‚   â”‚ Adds: Asset Tier (Tier 0/1/2), Business Owner, Support Group                     â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Exposure Context                                                                  â”‚ â”‚
â”‚   â”‚ Adds: Internet-facing?, Firewall reachability, Network zone (DMZ/Internal/OT)    â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>

                <!-- FULL KQL CORRELATION RULE -->
                <div class="workflow-box rounded-xl p-6 mb-4 phase-context">
                    <h3 class="text-blue-400 font-bold mb-4"><i class="fas fa-code mr-2"></i>3.2 Complete Correlation Rule (Production KQL)</h3>
                    <div class="bg-black/50 rounded-lg p-4 overflow-x-auto">
                        <pre class="text-xs text-cyan-400">
// ============================================================================
// VULNERABILITY RISK SCORING CORRELATION RULE
// Scheduled Analytics Rule - Runs every 4 hours
// Incident Creation: OFF (alerts trigger automation, not SOC)
// ============================================================================

// ----- STEP 1: Load Enrichment Watchlists -----
let EPSS_Scores = _GetWatchlist('EPSS_Scores')
    | project CveId = CVE, EPSS_Score = todouble(EPSS), EPSS_Percentile = todouble(Percentile);

let CISA_KEV = _GetWatchlist('CISA_KEV')
    | project CveId = CVE, KEV_DateAdded = todatetime(DateAdded), 
              KEV_DueDate = todatetime(DueDate), KEV_Vendor = Vendor;

let Asset_Criticality = _GetWatchlist('Asset_Criticality')
    | project DeviceName = Hostname, AssetTier, BusinessUnit, 
              AssetOwner = Owner, SupportGroup, InternetFacing = tobool(InternetFacing);

let Exposure_Context = _GetWatchlist('Exposure_Context')
    | project DeviceName = Hostname, NetworkZone, FirewallReachable = tobool(Reachable),
              DMZ = tobool(InDMZ);

// ----- STEP 2: Get TVM Vulnerabilities (Last 4 hours of new detections) -----
let TVM_Vulns = DeviceTvmSoftwareVulnerabilities
    | where TimeGenerated > ago(4h)
    | project 
        TimeGenerated,
        DeviceId,
        DeviceName,
        CveId,
        VulnerabilitySeverityLevel,
        CvssScore,
        SoftwareName,
        SoftwareVersion,
        RecommendedSecurityUpdate;

// ----- STEP 3: Get Qualys Vulnerabilities (if using Qualys) -----
let Qualys_Vulns = QualysVuln_CL
    | where TimeGenerated > ago(4h)
    | project
        TimeGenerated,
        DeviceName = Computer_s,
        CveId = CVE_s,
        CvssScore = CVSS_d,
        QualysQID = QID_s,
        Severity = Severity_s;

// ----- STEP 4: Union TVM + Qualys (deduplicate by CVE+Device) -----
let All_Vulns = TVM_Vulns
    | union Qualys_Vulns
    | summarize arg_max(TimeGenerated, *) by CveId, DeviceName;

// ----- STEP 5: Enrich with EPSS -----
let Enriched_EPSS = All_Vulns
    | join kind=leftouter EPSS_Scores on CveId
    | extend EPSS_Score = coalesce(EPSS_Score, 0.0);

// ----- STEP 6: Enrich with CISA KEV -----
let Enriched_KEV = Enriched_EPSS
    | join kind=leftouter CISA_KEV on CveId
    | extend 
        InKEV = isnotempty(KEV_DateAdded),
        KEV_Overdue = iff(isnotempty(KEV_DueDate), now() > KEV_DueDate, false);

// ----- STEP 7: Enrich with Asset Criticality -----
let Enriched_Asset = Enriched_KEV
    | join kind=leftouter Asset_Criticality on DeviceName
    | extend 
        AssetTier = coalesce(AssetTier, "Tier3"),
        InternetFacing = coalesce(InternetFacing, false);

// ----- STEP 8: Enrich with Exposure Context -----
let Enriched_Exposure = Enriched_Asset
    | join kind=leftouter Exposure_Context on DeviceName
    | extend 
        NetworkZone = coalesce(NetworkZone, "Internal"),
        InDMZ = coalesce(DMZ, false);

// ----- STEP 9: Calculate Risk Score -----
let Scored_Vulns = Enriched_Exposure
    | extend 
        // Base CVSS Score (0-100 scale)
        CVSS_Points = CvssScore * 10,
        
        // EPSS Multiplier (high exploit probability = higher score)
        EPSS_Points = EPSS_Score * 50,
        
        // CISA KEV (actively exploited = critical)
        KEV_Points = iff(InKEV, 100, 0),
        KEV_Overdue_Points = iff(KEV_Overdue, 50, 0),
        
        // Asset Criticality
        Asset_Points = case(
            AssetTier == "Tier0", 75,  // Domain Controllers, PKI, PAM
            AssetTier == "Tier1", 50,  // Critical business apps
            AssetTier == "Tier2", 25,  // Standard servers
            10                          // Workstations, other
        ),
        
        // Exposure
        Exposure_Points = case(
            InternetFacing and InDMZ, 50,  // Internet-facing in DMZ
            InternetFacing, 40,             // Internet-facing
            InDMZ, 25,                      // DMZ but not internet-facing
            NetworkZone == "OT", 30,        // OT network (sensitive)
            0                               // Internal only
        )
    | extend 
        RiskScore = CVSS_Points + EPSS_Points + KEV_Points + KEV_Overdue_Points + Asset_Points + Exposure_Points;

// ----- STEP 10: Assign Priority Tier and SLA -----
let Prioritized_Vulns = Scored_Vulns
    | extend 
        PriorityTier = case(
            RiskScore >= 200, "Critical",
            RiskScore >= 150, "High",
            RiskScore >= 100, "Medium",
            "Low"
        ),
        SLA_Days = case(
            RiskScore >= 200, 2,    // 48 hours
            RiskScore >= 150, 7,    // 7 days
            RiskScore >= 100, 30,   // 30 days
            90                       // 90 days
        ),
        SLA_Deadline = case(
            RiskScore >= 200, now() + 2d,
            RiskScore >= 150, now() + 7d,
            RiskScore >= 100, now() + 30d,
            now() + 90d
        );

// ----- STEP 11: Final Output (Only High-Risk for Alerting) -----
Prioritized_Vulns
| where RiskScore >= 150  // Only Critical and High trigger alerts
| project 
    TimeGenerated,
    DeviceName,
    CveId,
    CvssScore,
    EPSS_Score,
    InKEV,
    KEV_Overdue,
    AssetTier,
    AssetOwner,
    BusinessUnit,
    SupportGroup,
    InternetFacing,
    NetworkZone,
    RiskScore,
    PriorityTier,
    SLA_Days,
    SLA_Deadline,
    RecommendedAction = case(
        InKEV and KEV_Overdue, "URGENT: CISA KEV overdue - patch immediately",
        InKEV, strcat("CISA KEV - patch by ", format_datetime(KEV_DueDate, 'yyyy-MM-dd')),
        RiskScore >= 200, "Critical risk - patch within 48 hours",
        RiskScore >= 150, "High risk - patch within 7 days",
        "Schedule remediation per SLA"
    ),
    SoftwareName,
    RecommendedSecurityUpdate
| sort by RiskScore desc
                        </pre>
                    </div>
                    
                    <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-black/30 rounded-lg p-3">
                            <p class="text-yellow-400 font-semibold text-sm mb-2">Risk Score Weights:</p>
                            <ul class="text-gray-400 text-xs space-y-1">
                                <li>â€¢ CVSS Ã— 10 = 0-100 points</li>
                                <li>â€¢ EPSS Ã— 50 = 0-50 points</li>
                                <li>â€¢ CISA KEV = +100 points</li>
                                <li>â€¢ KEV Overdue = +50 points</li>
                                <li>â€¢ Tier 0 Asset = +75 points</li>
                                <li>â€¢ Internet-facing = +40-50 points</li>
                            </ul>
                        </div>
                        <div class="bg-black/30 rounded-lg p-3">
                            <p class="text-yellow-400 font-semibold text-sm mb-2">SLA Mapping:</p>
                            <ul class="text-gray-400 text-xs space-y-1">
                                <li>â€¢ Critical (â‰¥200): 48 hours</li>
                                <li>â€¢ High (150-199): 7 days</li>
                                <li>â€¢ Medium (100-149): 30 days</li>
                                <li>â€¢ Low (&lt;100): 90 days</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Watchlist Schema -->
                <div class="workflow-box rounded-xl p-6 mb-4 phase-context">
                    <h3 class="text-blue-400 font-bold mb-4"><i class="fas fa-table mr-2"></i>3.3 Watchlist Schemas</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-black/30 rounded-lg p-3">
                            <p class="text-cyan-400 font-semibold text-sm mb-2">EPSS_Scores Watchlist:</p>
                            <pre class="text-xs text-gray-400">
CVE,EPSS,Percentile
CVE-2024-1234,0.92,99.5
CVE-2024-5678,0.45,85.2
CVE-2024-9012,0.12,45.0
                            </pre>
                            <p class="text-gray-500 text-xs mt-2">Updated daily via Logic App from FIRST.org API</p>
                        </div>
                        <div class="bg-black/30 rounded-lg p-3">
                            <p class="text-cyan-400 font-semibold text-sm mb-2">CISA_KEV Watchlist:</p>
                            <pre class="text-xs text-gray-400">
CVE,DateAdded,DueDate,Vendor
CVE-2024-1234,2024-01-15,2024-01-29,Microsoft
CVE-2024-5678,2024-02-01,2024-02-15,Apache
                            </pre>
                            <p class="text-gray-500 text-xs mt-2">Updated daily via Logic App from CISA catalog</p>
                        </div>
                        <div class="bg-black/30 rounded-lg p-3">
                            <p class="text-cyan-400 font-semibold text-sm mb-2">Asset_Criticality Watchlist:</p>
                            <pre class="text-xs text-gray-400">
Hostname,AssetTier,Owner,SupportGroup,InternetFacing
DC-01,Tier0,john.doe,AD-Team,false
WEB-PROD-01,Tier1,jane.smith,Web-Team,true
APP-DEV-01,Tier2,dev.team,App-Team,false
                            </pre>
                            <p class="text-gray-500 text-xs mt-2">Synced weekly from ServiceNow CMDB</p>
                        </div>
                        <div class="bg-black/30 rounded-lg p-3">
                            <p class="text-cyan-400 font-semibold text-sm mb-2">Exposure_Context Watchlist:</p>
                            <pre class="text-xs text-gray-400">
Hostname,NetworkZone,Reachable,InDMZ
WEB-PROD-01,DMZ,true,true
DC-01,Internal,false,false
OT-PLC-01,OT,false,false
                            </pre>
                            <p class="text-gray-500 text-xs mt-2">Derived from firewall rules and network inventory</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PHASE 4 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">4.</span> Threshold Evaluation â†’ Alerts (Not Incidents)
                </h2>
                
                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-bell mr-2"></i>4.1 Sentinel Analytics Rule Configuration</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ANALYTICS RULE CONFIGURATION                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚   Rule Name:        "High-Risk Vulnerability Detected"                                  â”‚
â”‚   Description:      "Prioritized vulnerability requiring remediation action"            â”‚
â”‚   Severity:         Medium (this is for automation, not SOC priority)                  â”‚
â”‚   MITRE ATT&CK:     Initial Access (T1190 - Exploit Public-Facing Application)         â”‚
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  RULE LOGIC (uses the KQL from Phase 3)                                         â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  Frequency:        Every 4 hours                                                â”‚  â”‚
â”‚   â”‚  Lookback:         4 hours                                                      â”‚  â”‚
â”‚   â”‚  Alert Threshold:  Greater than 0 results                                       â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  Event Grouping:   Group all events into a single alert                         â”‚  â”‚
â”‚   â”‚                    (Logic App will process individual findings)                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  âš ï¸  CRITICAL SETTINGS:                                                          â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚  â”‚  Incident Settings:                                                       â”‚  â”‚  â”‚
â”‚   â”‚  â”‚                                                                           â”‚  â”‚  â”‚
â”‚   â”‚  â”‚  Create incidents from alerts = âŒ DISABLED                               â”‚  â”‚  â”‚
â”‚   â”‚  â”‚                                                                           â”‚  â”‚  â”‚
â”‚   â”‚  â”‚  WHY: These alerts are NOT for SOC triage. They trigger automation       â”‚  â”‚  â”‚
â”‚   â”‚  â”‚       that routes findings to vulnerability analysts via Power BI/CSV.   â”‚  â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚  â”‚  Automated Response:                                                      â”‚  â”‚  â”‚
â”‚   â”‚  â”‚                                                                           â”‚  â”‚  â”‚
â”‚   â”‚  â”‚  Run Playbook = âœ… ENABLED                                                â”‚  â”‚  â”‚
â”‚   â”‚  â”‚  Playbook:     "Vuln-ProcessHighRiskFindings"                             â”‚  â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>

                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-cog mr-2"></i>4.2 Entity Mapping</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ENTITY MAPPING                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚   Entity Type         Column                    Purpose                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   Host                DeviceName                Links to device entity graph           â”‚
â”‚   IP                  DeviceId                  Network correlation                    â”‚
â”‚                                                                                         â”‚
â”‚   Custom Details (passed to Logic App):                                                â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   CveId               CVE identifier                                                   â”‚
â”‚   RiskScore           Calculated priority score                                        â”‚
â”‚   PriorityTier        Critical/High/Medium/Low                                         â”‚
â”‚   SLA_Days            Remediation deadline                                             â”‚
â”‚   AssetOwner          From CMDB                                                        â”‚
â”‚   BusinessUnit        For routing                                                      â”‚
â”‚   InKEV               CISA KEV flag                                                    â”‚
â”‚   RecommendedAction   Human-readable guidance                                          â”‚
â”‚                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- PHASE 5 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">5.</span> Automation Trigger (Logic Apps)
                    <span class="ml-3 px-3 py-1 bg-emerald-500/20 text-emerald-400 text-sm rounded-full">YOUR AUTOMATION</span>
                </h2>

                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-project-diagram mr-2"></i>5.1 Logic App Workflow Diagram</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LOGIC APP: Vuln-ProcessHighRiskFindings                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  TRIGGER: When Azure Sentinel alert is triggered                                â”‚  â”‚
â”‚   â”‚           Alert Rule: "High-Risk Vulnerability Detected"                        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚                                                 â”‚
â”‚                                       â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  STEP 1: Parse Alert Entities                                                   â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  â€¢ Extract custom details from alert                                            â”‚  â”‚
â”‚   â”‚  â€¢ Get list of all vulnerability findings                                       â”‚  â”‚
â”‚   â”‚  â€¢ Parse JSON array of results                                                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚                                                 â”‚
â”‚                                       â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  STEP 2: De-duplication Check                                                   â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  For each finding:                                                              â”‚  â”‚
â”‚   â”‚  â€¢ Query SharePoint list: "Was this CVE+Device processed in last 24h?"          â”‚  â”‚
â”‚   â”‚  â€¢ If YES â†’ Skip (already in pipeline)                                          â”‚  â”‚
â”‚   â”‚  â€¢ If NO â†’ Continue processing                                                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚                                                 â”‚
â”‚                                       â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  STEP 3: Group by Business Unit / Owner                                         â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  â€¢ Group findings by BusinessUnit                                               â”‚  â”‚
â”‚   â”‚  â€¢ Group findings by AssetOwner                                                 â”‚  â”‚
â”‚   â”‚  â€¢ Prepare summary counts                                                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚                                                 â”‚
â”‚                                       â–¼                                                 â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚           â”‚                           â”‚                           â”‚                    â”‚
â”‚           â–¼                           â–¼                           â–¼                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚ OUTPUT 1:     â”‚           â”‚ OUTPUT 2:     â”‚           â”‚ OUTPUT 3:     â”‚           â”‚
â”‚   â”‚ CSV to        â”‚           â”‚ Power BI      â”‚           â”‚ ServiceNow    â”‚           â”‚
â”‚   â”‚ SharePoint    â”‚           â”‚ Dataset       â”‚           â”‚ Tickets       â”‚           â”‚
â”‚   â”‚               â”‚           â”‚               â”‚           â”‚               â”‚           â”‚
â”‚   â”‚ Path:         â”‚           â”‚ Push rows to  â”‚           â”‚ For Critical  â”‚           â”‚
â”‚   â”‚ /Security/    â”‚           â”‚ streaming     â”‚           â”‚ only:         â”‚           â”‚
â”‚   â”‚ VulnMgmt/     â”‚           â”‚ dataset       â”‚           â”‚ Auto-create   â”‚           â”‚
â”‚   â”‚ Daily/        â”‚           â”‚               â”‚           â”‚ ticket        â”‚           â”‚
â”‚   â”‚ YYYY-MM-DD.csvâ”‚           â”‚               â”‚           â”‚               â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚           â”‚                           â”‚                           â”‚                    â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                       â”‚                                                 â”‚
â”‚                                       â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  STEP 4: Send Notifications                                                     â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  Teams Adaptive Card to #vuln-management channel:                               â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚   â”‚  â”‚  ğŸ”´ 12 Critical | ğŸŸ  34 High vulnerabilities require review                 â”‚ â”‚  â”‚
â”‚   â”‚  â”‚                                                                            â”‚ â”‚  â”‚
â”‚   â”‚  â”‚  Top Impacted Assets:                                                      â”‚ â”‚  â”‚
â”‚   â”‚  â”‚  â€¢ DC-01 (5 critical)                                                      â”‚ â”‚  â”‚
â”‚   â”‚  â”‚  â€¢ WEB-PROD-01 (3 critical, 2 high)                                        â”‚ â”‚  â”‚
â”‚   â”‚  â”‚                                                                            â”‚ â”‚  â”‚
â”‚   â”‚  â”‚  [View Dashboard]  [Download CSV]  [Open ServiceNow Queue]                 â”‚ â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚   â”‚                                                                                  â”‚  â”‚
â”‚   â”‚  Email to vuln-team@company.com:                                                â”‚  â”‚
â”‚   â”‚  Subject: "Daily Vulnerability Review Queue - {date}"                           â”‚  â”‚
â”‚   â”‚  Attachment: CSV file                                                           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>

                <!-- Logic App JSON Definition -->
                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-code mr-2"></i>5.2 Logic App Actions (Pseudo-Code)</h3>
                    <div class="bg-black/50 rounded-lg p-4 overflow-x-auto">
                        <pre class="text-xs text-cyan-400">
// ============================================================================
// LOGIC APP: Vuln-ProcessHighRiskFindings
// Trigger: Sentinel Alert
// ============================================================================

// ----- TRIGGER -----
{
  "trigger": "Microsoft_Sentinel_alert",
  "alert_rule": "High-Risk Vulnerability Detected"
}

// ----- STEP 1: Initialize Variables -----
Initialize_CriticalCount = 0
Initialize_HighCount = 0
Initialize_FindingsArray = []
Initialize_ProcessedItems = []

// ----- STEP 2: Parse Alert Custom Details -----
Parse_JSON: @{triggerBody()?['ExtendedProperties']}
// Contains: Array of {DeviceName, CveId, RiskScore, PriorityTier, AssetOwner, etc.}

// ----- STEP 3: For Each Finding -----
For_Each_Finding:
  
  // Check deduplication (SharePoint list query)
  Check_Processed = SharePoint_GetItems(
    Site: "SecurityOperations",
    List: "VulnProcessingLog",
    Filter: "CVE eq '@{item().CveId}' and Device eq '@{item().DeviceName}' 
             and ProcessedDate ge '@{addDays(utcNow(), -1)}'"
  )
  
  If (length(Check_Processed) == 0):  // Not processed in last 24h
    
    // Add to findings array
    Append_To_Array(FindingsArray, {
      DeviceName: item().DeviceName,
      CveId: item().CveId,
      RiskScore: item().RiskScore,
      PriorityTier: item().PriorityTier,
      SLA_Days: item().SLA_Days,
      AssetOwner: item().AssetOwner,
      BusinessUnit: item().BusinessUnit,
      InKEV: item().InKEV,
      RecommendedAction: item().RecommendedAction,
      ProcessedDate: utcNow()
    })
    
    // Increment counters
    If (item().PriorityTier == "Critical"):
      Increment_CriticalCount
    If (item().PriorityTier == "High"):
      Increment_HighCount
    
    // Log to dedup list
    SharePoint_CreateItem(
      Site: "SecurityOperations",
      List: "VulnProcessingLog",
      CVE: item().CveId,
      Device: item().DeviceName,
      ProcessedDate: utcNow()
    )

// ----- STEP 4: Generate CSV -----
Create_CSV_Table = createCsvTable(FindingsArray)

SharePoint_CreateFile(
  Site: "SecurityOperations",
  FolderPath: "/Security/VulnMgmt/DailyReview",
  FileName: "@{formatDateTime(utcNow(), 'yyyy-MM-dd')}_VulnReview.csv",
  FileContent: Create_CSV_Table
)

// ----- STEP 5: Push to Power BI -----
For_Each_Finding_In_Array:
  PowerBI_AddRowsToDataset(
    Dataset: "VulnerabilityDashboard",
    Table: "DailyFindings",
    Row: current_finding
  )

// ----- STEP 6: Create ServiceNow Tickets (Critical Only) -----
Filter_Critical = Filter(FindingsArray, PriorityTier == "Critical")

For_Each_Critical:
  ServiceNow_CreateIncident(
    ShortDescription: "Critical Vulnerability: @{item().CveId} on @{item().DeviceName}",
    Description: "Risk Score: @{item().RiskScore}\n
                  CISA KEV: @{item().InKEV}\n
                  SLA: @{item().SLA_Days} days\n
                  Action: @{item().RecommendedAction}",
    AssignmentGroup: item().SupportGroup,
    AssignedTo: item().AssetOwner,
    Priority: 2,  // High
    Category: "Vulnerability",
    DueDate: addDays(utcNow(), item().SLA_Days)
  )

// ----- STEP 7: Send Teams Notification -----
Teams_PostAdaptiveCard(
  Channel: "#vuln-management",
  Card: {
    Title: "Daily Vulnerability Review Queue",
    Body: [
      {
        type: "ColumnSet",
        columns: [
          { header: "ğŸ”´ Critical", value: CriticalCount },
          { header: "ğŸŸ  High", value: HighCount }
        ]
      },
      {
        type: "TextBlock",
        text: "Review required for prioritized vulnerabilities"
      }
    ],
    Actions: [
      { type: "OpenUrl", title: "View Dashboard", url: PowerBI_Dashboard_URL },
      { type: "OpenUrl", title: "Download CSV", url: SharePoint_CSV_URL },
      { type: "OpenUrl", title: "ServiceNow Queue", url: ServiceNow_Queue_URL }
    ]
  }
)

// ----- STEP 8: Send Email Summary -----
Outlook_SendEmail(
  To: "vuln-team@company.com",
  Subject: "Daily Vulnerability Review - @{formatDateTime(utcNow(), 'yyyy-MM-dd')}",
  Body: "
    <h2>Vulnerability Review Queue</h2>
    <p>Critical: @{CriticalCount} | High: @{HighCount}</p>
    <p>Please review the attached CSV and take appropriate action.</p>
    <p><a href='@{PowerBI_Dashboard_URL}'>Open Dashboard</a></p>
  ",
  Attachments: [SharePoint_CSV_File]
)
                        </pre>
                    </div>
                </div>

                <!-- Output Examples -->
                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-file-export mr-2"></i>5.3 Output Examples</h3>
                    
                    <div class="grid grid-cols-1 gap-4">
                        <!-- CSV Output -->
                        <div class="bg-black/30 rounded-lg p-4">
                            <p class="text-yellow-400 font-semibold text-sm mb-2">CSV Output (SharePoint):</p>
                            <pre class="text-xs text-gray-400 overflow-x-auto">
DeviceName,CveId,CvssScore,EPSS,InKEV,RiskScore,PriorityTier,SLA_Days,AssetOwner,BusinessUnit,RecommendedAction
DC-01,CVE-2024-1234,9.8,0.92,TRUE,325,Critical,2,john.doe@company.com,IT-Infrastructure,"URGENT: CISA KEV overdue - patch immediately"
WEB-PROD-01,CVE-2024-5678,8.5,0.75,TRUE,280,Critical,2,jane.smith@company.com,Web-Services,"CISA KEV - patch by 2024-02-15"
APP-SERVER-03,CVE-2024-9012,7.5,0.45,FALSE,165,High,7,dev.team@company.com,Applications,"High risk - patch within 7 days"
                            </pre>
                        </div>

                        <!-- Teams Notification -->
                        <div class="bg-black/30 rounded-lg p-4">
                            <p class="text-yellow-400 font-semibold text-sm mb-2">Teams Adaptive Card:</p>
                            <div class="bg-gray-800 rounded-lg p-3 text-sm">
                                <p class="text-white font-bold">ğŸ›¡ï¸ Daily Vulnerability Review Queue</p>
                                <div class="flex gap-4 my-2">
                                    <span class="text-red-400">ğŸ”´ Critical: 12</span>
                                    <span class="text-orange-400">ğŸŸ  High: 34</span>
                                </div>
                                <p class="text-gray-400 text-xs mb-2">Top Impacted Assets:</p>
                                <ul class="text-gray-400 text-xs">
                                    <li>â€¢ DC-01 (5 critical) - IT-Infrastructure</li>
                                    <li>â€¢ WEB-PROD-01 (3 critical, 2 high) - Web-Services</li>
                                </ul>
                                <div class="flex gap-2 mt-3">
                                    <span class="px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded">View Dashboard</span>
                                    <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded">Download CSV</span>
                                    <span class="px-2 py-1 bg-purple-500/20 text-purple-400 text-xs rounded">ServiceNow Queue</span>
                                </div>
                            </div>
                        </div>

                        <!-- ServiceNow Ticket -->
                        <div class="bg-black/30 rounded-lg p-4">
                            <p class="text-yellow-400 font-semibold text-sm mb-2">ServiceNow Ticket (Auto-Created for Critical):</p>
                            <div class="bg-gray-800 rounded-lg p-3 text-xs">
                                <p class="text-white font-bold">INC0012345: Critical Vulnerability: CVE-2024-1234 on DC-01</p>
                                <div class="grid grid-cols-2 gap-2 mt-2 text-gray-400">
                                    <p><span class="text-gray-500">Priority:</span> 2 - High</p>
                                    <p><span class="text-gray-500">Category:</span> Vulnerability</p>
                                    <p><span class="text-gray-500">Assigned To:</span> john.doe@company.com</p>
                                    <p><span class="text-gray-500">Due Date:</span> 2024-01-17 (48h SLA)</p>
                                </div>
                                <p class="text-gray-400 mt-2">
                                    <span class="text-gray-500">Description:</span><br>
                                    Risk Score: 325<br>
                                    CISA KEV: Yes (actively exploited)<br>
                                    EPSS: 0.92 (92% exploit probability)<br>
                                    Action: URGENT - Apply patch KB5001234 immediately
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PHASE 6 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">6.</span> Vulnerability Analyst Consumption (Human Review)
                </h2>
                <div class="workflow-box rounded-xl p-6 mb-4 phase-manual">
                    <h3 class="text-yellow-400 font-bold mb-4"><i class="fas fa-user mr-2"></i>6.1 What Analysts Actually See</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         VULNERABILITY ANALYST WORKSPACE                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   âŒ ANALYSTS DO NOT:                                                                   â”‚
â”‚      â€¢ Open Sentinel incidents                                                          â”‚
â”‚      â€¢ Work from SOC queue                                                              â”‚
â”‚                                                                                         â”‚
â”‚   âœ… ANALYSTS WORK FROM:                                                                â”‚
â”‚      â€¢ Power BI Dashboards (interactive, drill-down)                                   â”‚
â”‚      â€¢ CSV Exports (filterable, bulk actions)                                          â”‚
â”‚      â€¢ Ticket Queues (ServiceNow/Jira)                                                 â”‚
â”‚                                                                                         â”‚
â”‚   VIEW CONTAINS:                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ Asset   â”‚ CVE      â”‚ RiskScore â”‚ EPSS â”‚ KEV â”‚ Exposure â”‚ Recommended    â”‚          â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚   â”‚ DC-01   â”‚ 2024-123 â”‚ 285       â”‚ 0.92 â”‚ âœ“   â”‚ Internal â”‚ Patch ASAP     â”‚          â”‚
â”‚   â”‚ WEB-03  â”‚ 2024-456 â”‚ 210       â”‚ 0.75 â”‚ âœ“   â”‚ Internet â”‚ Patch + WAF    â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- PHASE 7 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">7.</span> Manual Analyst Workflow (Validation Phase)
                </h2>
                <div class="bg-yellow-500/10 border border-yellow-500/50 rounded-xl p-4 mb-4">
                    <p class="text-yellow-400 font-bold"><i class="fas fa-exclamation-triangle mr-2"></i>This step is mandatory and expected. Not every finding becomes a ticket.</p>
                </div>
                <div class="workflow-box rounded-xl p-6 mb-4 phase-manual">
                    <h3 class="text-yellow-400 font-bold mb-4"><i class="fas fa-clipboard-check mr-2"></i>7.1 Analyst Review Steps</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ANALYST VALIDATION WORKFLOW                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   FOR EACH ITEM:                                                                        â”‚
â”‚                                                                                         â”‚
â”‚   1. VALIDATE VULNERABILITY ACCURACY                                                    â”‚
â”‚      â–¡ Is the scanner detection correct?                                               â”‚
â”‚      â–¡ Does the CVE apply to our config?                                               â”‚
â”‚                                                                                         â”‚
â”‚   2. CHECK COMPENSATING CONTROLS                                                        â”‚
â”‚      â–¡ Mitigated by NGFW rules?                                                        â”‚
â”‚      â–¡ Mitigated by EDR protection?                                                    â”‚
â”‚      â–¡ Network segmentation blocking attack path?                                      â”‚
â”‚                                                                                         â”‚
â”‚   3. ASSESS PATCH IMPACT                                                                â”‚
â”‚      â–¡ OT/ICS system? â†’ Vendor approval required                                       â”‚
â”‚      â–¡ Legacy system? â†’ May break application                                          â”‚
â”‚      â–¡ Critical workload? â†’ Needs change window                                        â”‚
â”‚                                                                                         â”‚
â”‚   4. DISPOSITION DECISION                                                               â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚      â”‚  FIX NOW    â”‚  â”‚   DEFER     â”‚  â”‚ ACCEPT RISK â”‚  â”‚  CLOSE FP   â”‚                â”‚
â”‚      â”‚  â†’ Ticket   â”‚  â”‚  â†’ Schedule â”‚  â”‚  â†’ Document â”‚  â”‚  â†’ Exclude  â”‚                â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- PHASE 8 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">8.</span> Ticket Creation & Assignment
                </h2>
                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-ticket-alt mr-2"></i>8.1 Ticket Creation Methods</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   OPTION A: AUTOMATED - Logic App creates tickets automatically                         â”‚
â”‚   OPTION B: SEMI-AUTOMATED - Analyst approves in dashboard, triggers ticket            â”‚
â”‚   OPTION C: BULK IMPORT - Analyst filters CSV, imports to ServiceNow/Jira              â”‚
â”‚                                                                                         â”‚
â”‚   TICKET INCLUDES: CVE, Asset, RiskScore, SLA, Owner, Remediation steps                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- PHASE 9 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">9.</span> Ticket Routing to Owners
                </h2>
                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-route mr-2"></i>9.1 CMDB Ownership Mapping</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CMDB MAPPING: Asset â†’ Application Owner / Infrastructure Owner / Support Group        â”‚
â”‚                                                                                         â”‚
â”‚   OWNERS RECEIVE:                                                                       â”‚
â”‚   âœ“ Clear remediation instructions                                                      â”‚
â”‚   âœ“ SLA expectations                                                                    â”‚
â”‚   âœ“ Risk context (KEV, EPSS, exposure)                                                 â”‚
â”‚   âœ“ Escalation path                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- PHASE 10 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">10.</span> Closure, Feedback & Continuous Improvement
                </h2>
                <div class="workflow-box rounded-xl p-6 mb-4 phase-automated">
                    <h3 class="text-green-400 font-bold mb-4"><i class="fas fa-sync-alt mr-2"></i>10.1 Feedback Loop</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   TICKET OUTCOMES FEED BACK INTO:                                                       â”‚
â”‚   â€¢ Risk Scoring Logic (adjust weights)                                                â”‚
â”‚   â€¢ Prioritization Thresholds (raise/lower based on capacity)                          â”‚
â”‚   â€¢ Exception Handling (auto-approval rules for known exceptions)                      â”‚
â”‚                                                                                         â”‚
â”‚   THIS CONTINUOUSLY:                                                                    â”‚
â”‚   âœ“ Reduces false positives over time                                                  â”‚
â”‚   âœ“ Improves prioritization accuracy                                                   â”‚
â”‚   âœ“ Adjusts SLAs based on actual remediation capacity                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- PHASE 11 -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">
                    <span class="text-red-400">11.</span> SOC Involvement (Only When Needed)
                    <span class="ml-3 px-3 py-1 bg-purple-500/20 text-purple-400 text-sm rounded-full">SEPARATE WORKFLOW</span>
                </h2>
                <div class="workflow-box rounded-xl p-6 mb-4 phase-soc">
                    <h3 class="text-purple-400 font-bold mb-4"><i class="fas fa-shield-alt mr-2"></i>11.1 When SOC Engages</h3>
                    <pre class="text-gray-300 text-sm">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SOC INVOLVEMENT (SEPARATE WORKFLOW)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   SOC ONLY ENGAGES IF a SEPARATE correlation rule detects:                              â”‚
â”‚                                                                                         â”‚
â”‚   â€¢ NGFW detects exploit traffic matching a known CVE                                  â”‚
â”‚   â€¢ EDR detects suspicious endpoint behavior (exploitation attempt)                    â”‚
â”‚   â€¢ IDS/IPS signature triggers for vulnerability exploitation                          â”‚
â”‚                                                                                         â”‚
â”‚   THEN:                                                                                 â”‚
â”‚   â”œâ”€â”€ Correlation rule creates Sentinel INCIDENT (not just alert)                      â”‚
â”‚   â”œâ”€â”€ Incident assigned to SOC queue                                                   â”‚
â”‚   â””â”€â”€ SOC investigates active exploitation attempt                                     â”‚
â”‚                                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Vulnerability data = CONTEXT for investigation, not the driver                 â”‚  â”‚
â”‚   â”‚  Exploit detection = DRIVER of SOC investigation                                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- Summary Flow -->
            <section>
                <h2 class="text-2xl font-bold text-white mb-4">Complete 11-Phase Flow</h2>
                <div class="workflow-box rounded-xl p-6">
                    <pre class="text-gray-300 text-xs overflow-x-auto">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1.SCAN â†’ 2.INGEST â†’ 3.ENRICH â†’ 4.ALERT â†’ 5.AUTOMATE â†’ 6.CONSUME â†’ 7.VALIDATE â†’ 8.TICKET â†’ 9.ROUTE â†’ 10.CLOSE â”‚
â”‚ Qualys   Sentinel   EPSS/KEV   (no      Logic App   Power BI   Manual FP   ServiceNow  CMDBâ†’     Feedback  â”‚
â”‚ TVM      Raw data   CMDB join  incident)            CSV        check       Jira        Owner     Loop      â”‚
â”‚                                                                                                            â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
â”‚ 11. SOC (SEPARATE) - Only when NGFW/EDR detects active exploitation â†’ Creates INCIDENT â†’ SOC investigates â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </pre>
                </div>
            </section>

            <!-- Environment Scope -->
            <div class="glass-card rounded-xl p-6 mt-8">
                <h3 class="text-xl font-bold text-white mb-4"><i class="fas fa-building text-blue-400 mr-2"></i>Environment Scope & Metrics</h3>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 text-center">
                        <p class="text-3xl font-bold text-blue-400">5,000+</p>
                        <p class="text-gray-400 text-sm">Endpoints</p>
                    </div>
                    <div class="bg-green-500/10 border border-green-500/30 rounded-lg p-4 text-center">
                        <p class="text-3xl font-bold text-green-400">2,500+</p>
                        <p class="text-gray-400 text-sm">Employees</p>
                    </div>
                    <div class="bg-purple-500/10 border border-purple-500/30 rounded-lg p-4 text-center">
                        <p class="text-3xl font-bold text-purple-400">~50K</p>
                        <p class="text-gray-400 text-sm">Raw Findings/Week</p>
                    </div>
                    <div class="bg-red-500/10 border border-red-500/30 rounded-lg p-4 text-center">
                        <p class="text-3xl font-bold text-red-400">~200</p>
                        <p class="text-gray-400 text-sm">Actionable/Week</p>
                    </div>
                </div>

                <div class="bg-black/30 rounded-lg p-4">
                    <p class="text-yellow-400 font-semibold mb-2"><i class="fas fa-filter mr-2"></i>Noise Reduction Impact:</p>
                    <p class="text-gray-300 text-sm">
                        Raw vulnerability scans across 5,000+ endpoints generated approximately <strong class="text-white">50,000+ findings per week</strong>. 
                        After risk-scoring with EPSS, CISA KEV, asset criticality, and exposure context, the pipeline filtered this down to 
                        approximately <strong class="text-white">200 actionable Critical/High findings</strong>â€”a <strong class="text-emerald-400">99.6% noise reduction</strong> 
                        that allowed vulnerability analysts to focus on what actually mattered.
                    </p>
                </div>
            </div>

            <!-- Role Positioning -->
            <div class="bg-amber-500/10 border border-amber-500/50 rounded-xl p-6 mt-6">
                <h3 class="text-amber-400 font-bold mb-3"><i class="fas fa-user-cog mr-2"></i>My Role: Migration & Engineering Support</h3>
                <p class="text-gray-300 text-sm mb-4">
                    The subsidiary's SOC remained operational throughout the RSA NetWitness to Microsoft Sentinel migration. 
                    My role was <strong class="text-white">migration and engineering support</strong>â€”building the detection rules, 
                    correlation logic, automation pipelines, and dashboardsâ€”followed by a <strong class="text-white">structured handover</strong> 
                    to the subsidiary's internal security team for steady-state operations.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div>
                        <p class="text-amber-400 font-semibold mb-2">What I Built:</p>
                        <ul class="text-gray-400 space-y-1">
                            <li>â€¢ Vulnerability risk-scoring correlation rules</li>
                            <li>â€¢ Logic App automation pipelines</li>
                            <li>â€¢ Power BI dashboards</li>
                            <li>â€¢ Watchlist ingestion workflows</li>
                            <li>â€¢ ServiceNow integration</li>
                        </ul>
                    </div>
                    <div>
                        <p class="text-amber-400 font-semibold mb-2">Handover Deliverables:</p>
                        <ul class="text-gray-400 space-y-1">
                            <li>â€¢ Runbook documentation</li>
                            <li>â€¢ SOC training sessions</li>
                            <li>â€¢ Workbook templates</li>
                            <li>â€¢ Tuning guidelines</li>
                            <li>â€¢ Escalation procedures</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Interview Talking Points -->
            <div class="glass-card rounded-xl p-6 mt-8">
                <h3 class="text-xl font-bold text-white mb-4"><i class="fas fa-microphone text-red-400 mr-2"></i>Interview Talking Points</h3>
                <div class="space-y-4 text-sm">
                    <div class="bg-black/30 rounded-lg p-4">
                        <p class="text-yellow-400 font-semibold mb-2">Q: "How do you prioritize vulnerabilities?"</p>
                        <p class="text-gray-300">"In our environment of 5,000+ endpoints supporting 2,500 employees, raw vulnerability scans generated around 50,000 findings per week. I built a risk-scoring pipeline in Sentinel that joined TVM and Qualys data with EPSS, CISA KEV, CMDB asset criticality, and exposure context. The calculated risk scoreâ€”not just CVSSâ€”determined priority and SLA. This filtered 50,000 findings down to about 200 actionable Critical/High items per week, a 99%+ noise reduction."</p>
                    </div>
                    <div class="bg-black/30 rounded-lg p-4">
                        <p class="text-yellow-400 font-semibold mb-2">Q: "Does SOC triage vulnerability alerts?"</p>
                        <p class="text-gray-300">"Noâ€”vulnerability management is a separate workflow from SOC incident response. My pipeline produces prioritized findings that go to Power BI dashboards and CSV exports for vulnerability analysts, not the SOC queue. SOC only gets involved when a separate correlation rule detects active exploitationâ€”like NGFW threat logs showing exploit traffic to an unpatched system. At that point, vulnerability data becomes context for the investigation, not the trigger."</p>
                    </div>
                    <div class="bg-black/30 rounded-lg p-4">
                        <p class="text-yellow-400 font-semibold mb-2">Q: "What was your role versus the SOC team?"</p>
                        <p class="text-gray-300">"The SOC remained operational throughout; my role was migration and engineering support. I built the correlation rules, automation pipelines, dashboards, and integrationsâ€”then conducted a structured handover to the subsidiary's internal security team. I delivered runbooks, training, workbook templates, and tuning guidelines so they could own steady-state operations. I wasn't running the SOC day-to-day; I was enabling it with modern tooling."</p>
                    </div>
                    <div class="bg-black/30 rounded-lg p-4">
                        <p class="text-yellow-400 font-semibold mb-2">Q: "How did you measure success of the vulnerability pipeline?"</p>
                        <p class="text-gray-300">"Three key metrics: First, noise reductionâ€”going from 50K to 200 actionable findings per week. Second, SLA complianceâ€”tracking what percentage of Critical vulnerabilities were remediated within 48 hours. Third, false positive rateâ€”feeding analyst dispositions back into the scoring logic to continuously improve prioritization accuracy. We also tracked CISA KEV compliance separately since those have federal deadlines."</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="flex justify-between mt-8">
                <a href="workflows-index.html" class="px-6 py-3 bg-gray-800 hover:bg-gray-700 rounded-lg text-gray-300 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>All Workflows
                </a>
                <a href="workflows-ngfw.html" class="px-6 py-3 bg-red-500/20 hover:bg-red-500/30 border border-red-500/50 rounded-lg text-red-400 transition-colors">
                    Next: Firewall Workflows<i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>

        </div>
    </div>
</body>
</html>
