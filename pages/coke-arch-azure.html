<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Hub & Spoke Architecture - Coca-Cola</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%); min-height: 100vh; }
        .glass-card { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(59, 130, 246, 0.2); }
        .diagram-box { background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(59, 130, 246, 0.3); font-family: 'Courier New', monospace; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body class="text-gray-100">
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 glass-card border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center">
                        <i class="fas fa-cloud text-blue-400"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-semibold text-white">Part 1: Azure Hub & Spoke</h1>
                        <p class="text-xs text-gray-400">Coca-Cola Cloud Architecture</p>
                    </div>
                </div>
                <a href="coke-arch-index.html" class="text-gray-400 hover:text-blue-400 transition-colors">
                    <i class="fas fa-th-large mr-2"></i>Architecture Index
                </a>
            </div>
        </div>
    </nav>

    <div class="pt-24 pb-12 px-6">
        <div class="max-w-6xl mx-auto space-y-8">

            <!-- Overview -->
            <div class="glass-card rounded-xl p-6">
                <h2 class="text-2xl font-bold text-white mb-4">
                    <i class="fas fa-cloud text-blue-400 mr-2"></i>Azure Hub & Spoke Network Topology
                </h2>
                <p class="text-gray-400 mb-4">
                    Coca-Cola Bottling uses a Hub-and-Spoke network topology in Azure. The Hub VNet contains shared security services 
                    (firewalls, VPN gateways, Sentinel workspace), while Spoke VNets contain isolated workloads. All traffic between 
                    spokes routes through the hub for centralized security inspection.
                </p>
                <div class="grid grid-cols-3 gap-4">
                    <div class="bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 text-center">
                        <div class="text-2xl font-bold text-blue-400">1</div>
                        <div class="text-xs text-gray-400">Hub VNet</div>
                    </div>
                    <div class="bg-green-500/10 border border-green-500/30 rounded-lg p-3 text-center">
                        <div class="text-2xl font-bold text-green-400">8+</div>
                        <div class="text-xs text-gray-400">Spoke VNets</div>
                    </div>
                    <div class="bg-purple-500/10 border border-purple-500/30 rounded-lg p-3 text-center">
                        <div class="text-2xl font-bold text-purple-400">3</div>
                        <div class="text-xs text-gray-400">Azure Regions</div>
                    </div>
                </div>
            </div>

            <!-- Main Hub-Spoke Diagram -->
            <div class="diagram-box rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4">Complete Hub-Spoke Architecture</h3>
                <pre class="text-gray-300 text-xs">
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                           COCA-COLA AZURE HUB & SPOKE ARCHITECTURE                                      │
│                                    (Primary Region: East US)                                            │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘

                                        ┌─────────────────────┐
                                        │     INTERNET        │
                                        └──────────┬──────────┘
                                                   │
                                        ┌──────────┴──────────┐
                                        │  Azure Front Door   │
                                        │  (Global CDN/WAF)   │
                                        └──────────┬──────────┘
                                                   │
┌──────────────────────────────────────────────────┴──────────────────────────────────────────────────────┐
│                                                                                                          │
│                              ╔═══════════════════════════════════════════╗                              │
│                              ║           HUB VNET (10.0.0.0/16)          ║                              │
│                              ║          "coke-hub-vnet-eastus"           ║                              │
│                              ╠═══════════════════════════════════════════╣                              │
│                              ║                                           ║                              │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │ GATEWAY SUBNET (10.0.0.0/24)                                                                    │   │
│  │ ┌───────────────────────┐  ┌───────────────────────┐  ┌───────────────────────┐                │   │
│  │ │ ExpressRoute Gateway  │  │ VPN Gateway           │  │ VPN Gateway           │                │   │
│  │ │ (to Plants/DC)        │  │ (Site-to-Site)        │  │ (Point-to-Site)       │                │   │
│  │ │ UltraPerformance SKU  │  │ VpnGw2 - Active/Active│  │ For Remote Admins     │                │   │
│  │ └───────────────────────┘  └───────────────────────┘  └───────────────────────┘                │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                              ║                                           ║                              │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │ FIREWALL SUBNET (10.0.1.0/24)                                        AzureFirewallSubnet       │   │
│  │ ┌───────────────────────────────────────────────────────────────────────────────────────────┐  │   │
│  │ │                           AZURE FIREWALL PREMIUM (HA)                                     │  │   │
│  │ │                                                                                           │  │   │
│  │ │  ┌─────────────────┐           ┌─────────────────┐                                       │  │   │
│  │ │  │ FW Instance 1   │◄─────────►│ FW Instance 2   │   Availability Zone Redundant         │  │   │
│  │ │  │ (Zone 1)        │  Active/  │ (Zone 2)        │   • TLS Inspection                    │  │   │
│  │ │  │                 │  Active   │                 │   • IDPS Signatures                   │  │   │
│  │ │  └─────────────────┘           └─────────────────┘   • Web Categories                    │  │   │
│  │ │                          │                           • Threat Intelligence              │  │   │
│  │ │                          ▼                                                               │  │   │
│  │ │              ┌─────────────────────┐                                                     │  │   │
│  │ │              │ Azure Firewall      │                                                     │  │   │
│  │ │              │ Policy (Centralized)│                                                     │  │   │
│  │ │              │ "coke-fw-policy"    │                                                     │  │   │
│  │ │              └─────────────────────┘                                                     │  │   │
│  │ └───────────────────────────────────────────────────────────────────────────────────────────┘  │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                              ║                                           ║                              │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │ NVA SUBNET (10.0.2.0/24)                                              For Advanced Inspection   │   │
│  │ ┌─────────────────────────────────────────────────────────────────────────────────────────────┐│   │
│  │ │                         PALO ALTO VM-SERIES (HA Pair)                                       ││   │
│  │ │                                                                                             ││   │
│  │ │  ┌───────────────────┐              ┌───────────────────┐                                  ││   │
│  │ │  │ PA-VM-50 (Active) │◄────────────►│ PA-VM-50 (Passive)│                                  ││   │
│  │ │  │                   │   Heartbeat  │                   │                                  ││   │
│  │ │  │ • Threat Prevent  │              │ • Threat Prevent  │    Managed by Panorama          ││   │
│  │ │  │ • URL Filtering   │              │ • URL Filtering   │    (On-Prem or Cloud)           ││   │
│  │ │  │ • WildFire        │              │ • WildFire        │                                  ││   │
│  │ │  │ • SSL Decrypt     │              │ • SSL Decrypt     │                                  ││   │
│  │ │  └───────────────────┘              └───────────────────┘                                  ││   │
│  │ │                                             │                                              ││   │
│  │ │                              Load Balancer (Internal)                                      ││   │
│  │ │                                     for HA                                                 ││   │
│  │ └─────────────────────────────────────────────────────────────────────────────────────────────┘│   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                              ║                                           ║                              │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────┐   │
│  │ SHARED SERVICES SUBNET (10.0.3.0/24)                                                           │   │
│  │                                                                                                 │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │   │
│  │  │ Azure       │  │ Log         │  │ Azure       │  │ Key Vault   │  │ Private     │          │   │
│  │  │ Bastion     │  │ Analytics   │  │ Automation  │  │ (Secrets)   │  │ DNS Zones   │          │   │
│  │  │ (Jump)      │  │ Workspace   │  │ (Patching)  │  │             │  │             │          │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘          │   │
│  │                           │                                                                    │   │
│  │                           ▼                                                                    │   │
│  │              ┌─────────────────────────────────────────────────┐                              │   │
│  │              │         MICROSOFT SENTINEL                      │                              │   │
│  │              │         (Connected to Log Analytics)            │                              │   │
│  │              │                                                 │                              │   │
│  │              │  Data Connectors:                              │                              │   │
│  │              │  • Azure AD / Entra ID                         │                              │   │
│  │              │  • Microsoft 365                               │                              │   │
│  │              │  • Defender for Cloud                          │                              │   │
│  │              │  • Azure Activity                              │                              │   │
│  │              │  • Azure Firewall                              │                              │   │
│  │              │  • Palo Alto (CEF)                             │                              │   │
│  │              │  • On-Prem via AMA                             │                              │   │
│  │              └─────────────────────────────────────────────────┘                              │   │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                              ║                                           ║                              │
│                              ╚═══════════════════════════════════════════╝                              │
│                                                   │                                                      │
│                                           VNet Peering                                                   │
│                    ┌──────────────┬───────────────┼───────────────┬──────────────┐                      │
│                    │              │               │               │              │                      │
│                    ▼              ▼               ▼               ▼              ▼                      │
│  ┌──────────────────┐ ┌──────────────────┐ ┌──────────────────┐ ┌──────────────────┐ ┌──────────────────┐│
│  │ SPOKE 1          │ │ SPOKE 2          │ │ SPOKE 3          │ │ SPOKE 4          │ │ SPOKE 5          ││
│  │ Production       │ │ SAP/ERP          │ │ Data Platform    │ │ Dev/Test         │ │ DMZ              ││
│  │ 10.1.0.0/16      │ │ 10.2.0.0/16      │ │ 10.3.0.0/16      │ │ 10.4.0.0/16      │ │ 10.5.0.0/16      ││
│  │                  │ │                  │ │                  │ │                  │ │                  ││
│  │ ┌──────────────┐ │ │ ┌──────────────┐ │ │ ┌──────────────┐ │ │ ┌──────────────┐ │ │ ┌──────────────┐ ││
│  │ │ Web Apps     │ │ │ │ SAP HANA     │ │ │ │ Synapse      │ │ │ │ Dev VMs      │ │ │ │ App Gateway  │ ││
│  │ │ APIs         │ │ │ │ SAP S/4      │ │ │ │ Data Lake    │ │ │ │ Test K8s     │ │ │ │ WAF          │ ││
│  │ │ AKS Cluster  │ │ │ │ SAP BW       │ │ │ │ Databricks   │ │ │ │ Sandboxes    │ │ │ │ Public LB    │ ││
│  │ │ Functions    │ │ │ │ Integration  │ │ │ │ ML Workspace │ │ │ │              │ │ │ │              │ ││
│  │ └──────────────┘ │ │ └──────────────┘ │ │ └──────────────┘ │ │ └──────────────┘ │ │ └──────────────┘ ││
│  │                  │ │                  │ │                  │ │                  │ │                  ││
│  │ NSG: Prod-NSG    │ │ NSG: SAP-NSG     │ │ NSG: Data-NSG    │ │ NSG: DevTest-NSG │ │ NSG: DMZ-NSG     ││
│  └──────────────────┘ └──────────────────┘ └──────────────────┘ └──────────────────┘ └──────────────────┘│
│                                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                </pre>
            </div>

            <!-- VNet Peering Details -->
            <div class="diagram-box rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4">VNet Peering & Routing Configuration</h3>
                <pre class="text-gray-300 text-xs">
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                              VNET PEERING CONFIGURATION                                                 │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘

    PEERING SETTINGS (Hub to each Spoke):
    ┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
    │                                                                                                   │
    │  Hub → Spoke Peering:                          Spoke → Hub Peering:                              │
    │  ┌─────────────────────────────────────┐      ┌─────────────────────────────────────┐            │
    │  │ Allow Virtual Network Access: ✅    │      │ Allow Virtual Network Access: ✅    │            │
    │  │ Allow Forwarded Traffic: ✅         │      │ Allow Forwarded Traffic: ✅         │            │
    │  │ Allow Gateway Transit: ✅           │      │ Use Remote Gateway: ✅              │            │
    │  │ Use Remote Gateway: ❌              │      │ Allow Gateway Transit: ❌           │            │
    │  └─────────────────────────────────────┘      └─────────────────────────────────────┘            │
    │                                                                                                   │
    │  KEY POINT: "Allow Gateway Transit" on Hub lets Spokes use Hub's ExpressRoute/VPN               │
    └───────────────────────────────────────────────────────────────────────────────────────────────────┘

    ROUTE TABLES (UDR - User Defined Routes):
    ┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
    │                                                                                                   │
    │  SPOKE ROUTE TABLE (Applied to all Spoke subnets):                                               │
    │  ┌─────────────────────────────────────────────────────────────────────────────────────────────┐ │
    │  │ Name              │ Address Prefix    │ Next Hop Type      │ Next Hop IP                    │ │
    │  ├───────────────────┼───────────────────┼────────────────────┼────────────────────────────────┤ │
    │  │ ToInternet        │ 0.0.0.0/0         │ Virtual Appliance  │ 10.0.1.4 (Azure FW)            │ │
    │  │ ToOnPrem          │ 192.168.0.0/16    │ Virtual Appliance  │ 10.0.1.4 (Azure FW)            │ │
    │  │ ToOtherSpokes     │ 10.0.0.0/8        │ Virtual Appliance  │ 10.0.1.4 (Azure FW)            │ │
    │  │ ToSAPWorkloads    │ 10.2.0.0/16       │ Virtual Appliance  │ 10.0.2.4 (Palo Alto)*          │ │
    │  └─────────────────────────────────────────────────────────────────────────────────────────────┘ │
    │                                                                                                   │
    │  * SAP traffic routes through Palo Alto for advanced inspection                                  │
    │                                                                                                   │
    │  WHY FORCE THROUGH FIREWALL?                                                                     │
    │  • All spoke-to-spoke traffic inspected                                                          │
    │  • All internet egress logged and filtered                                                       │
    │  • Centralized policy enforcement                                                                │
    │  • Compliance requirement (audit trail)                                                          │
    └───────────────────────────────────────────────────────────────────────────────────────────────────┘

    TRAFFIC FLOW EXAMPLE (Spoke 1 → Internet):
    ┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
    │                                                                                                   │
    │  ┌─────────────┐      ┌─────────────┐      ┌─────────────┐      ┌─────────────┐                  │
    │  │ VM in       │      │ UDR forces  │      │ Azure       │      │ Internet    │                  │
    │  │ Spoke 1     │─────▶│ to Hub      │─────▶│ Firewall    │─────▶│             │                  │
    │  │ 10.1.0.10   │      │             │      │ 10.0.1.4    │      │             │                  │
    │  └─────────────┘      └─────────────┘      └─────────────┘      └─────────────┘                  │
    │                                                   │                                               │
    │                                                   ▼                                               │
    │                                            ┌─────────────┐                                        │
    │                                            │ Logs to     │                                        │
    │                                            │ Sentinel    │                                        │
    │                                            └─────────────┘                                        │
    └───────────────────────────────────────────────────────────────────────────────────────────────────┘
                </pre>
            </div>

            <!-- ExpressRoute Configuration -->
            <div class="diagram-box rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4">ExpressRoute & Hybrid Connectivity</h3>
                <pre class="text-gray-300 text-xs">
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                              EXPRESSROUTE CONNECTIVITY                                                  │
│                    (Connecting Azure to Plants/Distribution Centers)                                    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────┘

                                        ┌─────────────────────────────────┐
                                        │         AZURE HUB VNET          │
                                        │                                 │
                                        │  ┌─────────────────────────┐   │
                                        │  │ ExpressRoute Gateway    │   │
                                        │  │ UltraPerformance SKU    │   │
                                        │  │ (Up to 10 Gbps)         │   │
                                        │  └────────────┬────────────┘   │
                                        └───────────────┼────────────────┘
                                                        │
                                                        │ ExpressRoute Circuit
                                                        │ (Private Peering)
                                                        │
                            ┌───────────────────────────┼───────────────────────────┐
                            │                           │                           │
                            ▼                           ▼                           ▼
                ┌───────────────────────┐   ┌───────────────────────┐   ┌───────────────────────┐
                │ EXPRESSROUTE CIRCUIT 1│   │ EXPRESSROUTE CIRCUIT 2│   │ EXPRESSROUTE CIRCUIT 3│
                │ "coke-er-eastus"      │   │ "coke-er-westus"      │   │ "coke-er-europe"      │
                │                       │   │                       │   │                       │
                │ Provider: AT&T        │   │ Provider: Verizon     │   │ Provider: Equinix     │
                │ Bandwidth: 10 Gbps    │   │ Bandwidth: 5 Gbps     │   │ Bandwidth: 5 Gbps     │
                │ SKU: Premium          │   │ SKU: Premium          │   │ SKU: Premium          │
                └───────────┬───────────┘   └───────────┬───────────┘   └───────────┬───────────┘
                            │                           │                           │
                            │ MPLS                      │ MPLS                      │ MPLS
                            │ Backbone                  │ Backbone                  │ Backbone
                            │                           │                           │
        ┌───────────────────┴───────────────────────────┴───────────────────────────┴───────────────────┐
        │                                                                                               │
        │                              CARRIER MPLS NETWORK                                            │
        │                          (Private WAN Connectivity)                                          │
        │                                                                                               │
        └───────────────────────────────────────────────────────────────────────────────────────────────┘
                            │                           │                           │
            ┌───────────────┴───────┐       ┌───────────┴───────┐       ┌───────────┴───────┐
            │                       │       │                   │       │                   │
            ▼                       ▼       ▼                   ▼       ▼                   ▼
    ┌───────────────┐       ┌───────────────┐       ┌───────────────┐       ┌───────────────┐
    │ PLANT         │       │ PLANT         │       │ DISTRIBUTION  │       │ HQ DATA       │
    │ Atlanta       │       │ Dallas        │       │ CENTER        │       │ CENTER        │
    │               │       │               │       │ Chicago       │       │ Atlanta       │
    │ 192.168.1.0/24│       │ 192.168.2.0/24│       │ 192.168.10.0/24│      │ 192.168.100.0/24│
    └───────────────┘       └───────────────┘       └───────────────┘       └───────────────┘


    EXPRESSROUTE REDUNDANCY:
    ┌───────────────────────────────────────────────────────────────────────────────────────────────────┐
    │                                                                                                   │
    │  Each ExpressRoute circuit has TWO physical connections (Primary + Secondary)                    │
    │                                                                                                   │
    │  ┌─────────────────┐                                      ┌─────────────────┐                    │
    │  │ Microsoft Edge  │──────── Primary Connection ─────────│ Customer/Partner│                    │
    │  │ Router (MSEE)   │                                      │ Edge Router     │                    │
    │  │                 │──────── Secondary Connection ────────│                 │                    │
    │  └─────────────────┘                                      └─────────────────┘                    │
    │                                                                                                   │
    │  PLUS: Multiple circuits across regions for geographic redundancy                                │
    │  RESULT: No single point of failure between Azure and on-premises                                │
    └───────────────────────────────────────────────────────────────────────────────────────────────────┘
                </pre>
            </div>

            <!-- Summary Box -->
            <div class="glass-card rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4"><i class="fas fa-key text-blue-400 mr-2"></i>Key Interview Points</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm">
                    <div>
                        <p class="text-blue-400 font-semibold mb-2">Why Hub-Spoke?</p>
                        <ul class="text-gray-400 space-y-1">
                            <li>• Centralized security inspection</li>
                            <li>• Shared services (Bastion, DNS, Firewall)</li>
                            <li>• Cost optimization (single gateway)</li>
                            <li>• Workload isolation between spokes</li>
                            <li>• Simplified management</li>
                        </ul>
                    </div>
                    <div>
                        <p class="text-green-400 font-semibold mb-2">Critical Design Decisions:</p>
                        <ul class="text-gray-400 space-y-1">
                            <li>• UDRs force traffic through firewall</li>
                            <li>• Gateway Transit shares ExpressRoute</li>
                            <li>• Zone-redundant firewalls for HA</li>
                            <li>• Multiple ExpressRoute circuits</li>
                            <li>• Private DNS zones for PaaS services</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="flex justify-between mt-8">
                <a href="coke-arch-index.html" class="px-6 py-3 bg-gray-800 hover:bg-gray-700 rounded-lg text-gray-300 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>Architecture Index
                </a>
                <a href="coke-arch-network.html" class="px-6 py-3 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/50 rounded-lg text-blue-400 transition-colors">
                    Part 2: Firewalls & Load Balancers<i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>

        </div>
    </div>
</body>
</html>
